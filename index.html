<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <title>To-Do List</title>
</head>

<body>
    <section>
        <div class="modal fade" id="myModal" role="dialog">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Todo Form</h5>
  
                <button
                  type="button"
                  class="btn btn-danger bg-danger border-0 btn-"
                  data-dismiss="modal"
                >
                  &times;
                </button>
              </div>
              <div class="modal-body">
                <div class="container mt-2 border rounded p-4">
                  <form>
                    <div class="form-group">
                      <label for="task">Task</label>
                      <textarea
                        class="form-control"
                        id="task"
                        rows="2"
                        placeholder="Enter your task"
                      ></textarea>
                    </div>
                    <div class="form-group">
                      <label for="date">Date</label>
                      <input
                        type="date"
                        class="form-control"
                        id="date"
                        placeholder="Select date"
                      />
                    </div>
                    <div class="form-group">
                      <label for="urgent">Urgent</label>
                      <select class="form-control" id="urgent">
                        <option value="yes">Yes</option>
                        <option value="no">No</option>
                      </select>
                    </div>
                    <button
                      type="button"
                      class="mt-2 btn btn-primary"
                      data-dismiss="modal"
                      onclick="addTask()"
                    >
                      Save
                    </button>
                    <input type="hidden" name="index" id="editIndex" value="" />
                    <input type="hidden" name="isEdit" id="isEdit" value="0" />
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

<script>
      let todo = [];
      var islocalPresent = localStorage.getItem("todolist");
      if (islocalPresent !== null) {
        todo = JSON.parse(islocalPresent);
        console.log("Parsed Local Storage Data:", todo);
        display();
      }
      function addTask() {
        if (!validateForm()) {
          return;
        }
        var task = document.getElementById("task").value;
        var date = document.getElementById("date").value;
        var urgent = document.getElementById("urgent").value;

        if (!validate(task, date, urgent)) {
          return;
        }
        var isEdit = document.getElementById("isEdit").value;

        if (isEdit === "1") {
          var editIndex = document.getElementById("editIndex").value;
          if (editIndex >= 0 && editIndex < todo.length) {
            todo[editIndex].task = task;
            todo[editIndex].date = date;
            todo[editIndex].urgent = urgent === "yes";
            todo[editIndex].complete = false;
          }
        } else {
          todo.push({
            task: task,
            date: date,
            urgent: urgent === "yes",
            complete: false,
          });
        }
        localStorage.setItem("todolist", JSON.stringify(todo));
        document.getElementById("isEdit").value = "0";
        document.getElementById("editIndex").value = "";
        document.getElementById("task").value = "";
        document.getElementById("date").value = "";
        // document.getElementById("urgent").value = "yes";

        closeModal();

        display();
      }

      function validateForm() {
        var task = document.getElementById("task").value;
        var date = document.getElementById("date").value;
        var urgent = document.getElementById("urgent").value;

        if (!task || !date) {
          alert("Task and Date are required fields.");
          return false;
        }

        if (!validate(task, date, urgent)) {
          return false;
        }

        return true;
      }
   

 </script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
</body>
</html>